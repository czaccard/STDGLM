<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulated Data Analysis • STDGLM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulated Data Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">STDGLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/STDGLM.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/fit_simulated.html">Simulated Data Analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/czaccard/STDGLM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulated Data Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/czaccard/STDGLM/blob/HEAD/vignettes/articles/fit_simulated.Rmd" class="external-link"><code>vignettes/articles/fit_simulated.Rmd</code></a></small>
      <div class="d-none name"><code>fit_simulated.Rmd</code></div>
    </div>

    
    
<p>This article demonstrates how to fit a spatio-temporal dynamic
generalized linear model (STDGLM) to simulated data using the
<code>STDGLM</code> package. First, we load the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/czaccard/STDGLM" class="external-link">STDGLM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.3.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.1.0     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.13.1, GDAL 3.11.0, PROJ 9.6.0; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="section level2">
<h2 id="data-generation">Data Generation<a class="anchor" aria-label="anchor" href="#data-generation"></a>
</h2>
<p>The following chunk generates some covariates. We randomly sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">p=30</annotation></semantics></math>
spatial locations within the unit square. At these locations, we
generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">J=3</annotation></semantics></math>
covariates (<code>X</code>) whose effects vary in spacetime, the first
one being an intercept, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q=1</annotation></semantics></math>
covariate (<code>z</code>) whose effect is held constant.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">coords</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">dist_mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">J</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">J</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">J</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t_</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">j</span><span class="op">*</span><span class="va">t_</span><span class="op">)</span></span>
<span>    <span class="va">X</span><span class="op">[</span>, <span class="va">t_</span>, <span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">q</span><span class="op">=</span><span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="va">t</span><span class="op">*</span><span class="va">q</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">q</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then we simulate some varying coefficients and plot them.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">1.5</span>, length.out <span class="op">=</span> <span class="va">p</span><span class="op">)</span>,</span>
<span>  <span class="fl">0</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length.out <span class="op">=</span> <span class="va">t</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">-</span> <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length.out <span class="op">=</span> <span class="va">t</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tempo</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span></span>
<span>  <span class="op">-</span> <span class="fl">.6</span><span class="op">*</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span><span class="op">-</span><span class="fl">.9</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">.6</span><span class="op">*</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span><span class="op">-</span><span class="fl">.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">/</span><span class="va">t</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span> <span class="op">+</span> <span class="fl">3</span>, FUN <span class="op">=</span> <span class="st">"+"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span></span>
<span>  <span class="op">-</span> <span class="fl">.6</span><span class="op">*</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span><span class="op">-</span><span class="fl">.9</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span><span class="op">-</span><span class="fl">.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  <span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">/</span><span class="va">t</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">/</span><span class="va">t</span><span class="op">*</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>, </span>
<span>  FUN <span class="op">=</span> <span class="st">"+"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, main <span class="op">=</span> <span class="st">'Beta 0'</span>, xlab <span class="op">=</span> <span class="st">'Time'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">beta1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, main <span class="op">=</span> <span class="st">'Beta 1'</span>, xlab <span class="op">=</span> <span class="st">'Time'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">beta2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, main <span class="op">=</span> <span class="st">'Beta 2'</span>, xlab <span class="op">=</span> <span class="st">'Time'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
<p>Next, we simulate the response variable <code>Y</code> using the
observation equation. The observation error is assumed to be normally
distributed with mean zero and variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma_\epsilon^2 = 2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">eps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="va">t</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta1</span><span class="op">*</span><span class="va">X</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta2</span><span class="op">*</span><span class="va">X</span><span class="op">[</span>,,<span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">*</span><span class="va">z</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">eps</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, main <span class="op">=</span> <span class="st">'Y'</span>, xlab <span class="op">=</span> <span class="st">'Time'</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p>Before fitting the model, we need to prepare a list of prior
hyperparameters. Here, we assume vague priors for all the parameters.
These are also the default values used when <code>prior=NULL</code> in
the <code>stdglm</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  V_beta_0 <span class="op">=</span> <span class="fl">1e4</span>, <span class="co"># Prior variance of initial state</span></span>
<span>  V_gamma <span class="op">=</span> <span class="fl">1e6</span>,  <span class="co"># Prior variance of constant coefficients</span></span>
<span>  a1 <span class="op">=</span> <span class="fl">0.01</span>,      <span class="co"># Prior shape for temporal variance</span></span>
<span>  b1 <span class="op">=</span> <span class="fl">0.01</span>,      <span class="co"># Prior rate for temporal variance</span></span>
<span>  s2_a <span class="op">=</span> <span class="fl">0.01</span>,    <span class="co"># Prior shape for measurement error variance</span></span>
<span>  s2_b <span class="op">=</span> <span class="fl">0.01</span>     <span class="co"># Prior rate for measurement error variance</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The MCMC setup is provided in the next chunk. You can adjust the
number of iterations, burn-in period, thinning interval, and other
parameters as needed. The <code>point.referenced</code> argument
indicates that the data are point-referenced, and
<code>random.walk</code> specifies that we want to use a random walk
structure for time-varying parameters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nburn</span> <span class="op">&lt;-</span> <span class="fl">200</span>                <span class="co"># burn-in period</span></span>
<span><span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">200</span>                 <span class="co"># number of iterations to save after burn-in</span></span>
<span><span class="va">thin</span> <span class="op">&lt;-</span> <span class="fl">1</span>                   <span class="co"># thinning interval</span></span>
<span><span class="va">point.referenced</span> <span class="op">=</span> <span class="cn">TRUE</span>     <span class="co"># data are point-referenced</span></span>
<span><span class="va">random.walk</span> <span class="op">=</span> <span class="cn">TRUE</span>          <span class="co"># random walk structure for time-varying parameters</span></span>
<span><span class="va">print.interval</span> <span class="op">=</span> <span class="fl">50</span>         <span class="co"># print message during execution of MCMC</span></span></code></pre></div>
<p>The following command executes the MCMC algorithm to fit the STDGLM
model to the simulated data. The <code>stdglm</code> function takes the
response variable <code>Y</code>, covariates <code>X</code> and
<code>z</code>, and other parameters defined above. The output is an
object of class <code>stdglm</code>, i.e. a list containing the MCMC
samples and other posterior summaries. The output is described in a
separate article.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stdglm.html">stdglm</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, Z<span class="op">=</span><span class="va">z</span>, </span>
<span>              point.referenced<span class="op">=</span><span class="va">point.referenced</span>, </span>
<span>              random.walk<span class="op">=</span><span class="va">random.walk</span>, </span>
<span>              W<span class="op">=</span><span class="va">dist_mat</span>,</span>
<span>              nrep<span class="op">=</span><span class="va">nrep</span>, nburn<span class="op">=</span><span class="va">nburn</span>, thin<span class="op">=</span><span class="va">thin</span>, </span>
<span>              print.interval<span class="op">=</span><span class="va">print.interval</span>, </span>
<span>              prior<span class="op">=</span><span class="va">prior_list</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting MCMC (400 iterations)...</span></span>
<span><span class="co">#&gt; Iteration: 50 / 400</span></span>
<span><span class="co">#&gt; Iteration: 100 / 400</span></span>
<span><span class="co">#&gt; Iteration: 150 / 400</span></span>
<span><span class="co">#&gt; Iteration: 200 / 400</span></span>
<span><span class="co">#&gt; Iteration: 250 / 400</span></span>
<span><span class="co">#&gt; Iteration: 300 / 400</span></span>
<span><span class="co">#&gt; Iteration: 350 / 400</span></span>
<span><span class="co">#&gt; Iteration: 400 / 400</span></span>
<span><span class="co">#&gt; MCMC finished.</span></span></code></pre></div>
<div class="section level3">
<h3 id="fitted-and-plot-methods">
<code>fitted</code> and <code>plot</code> methods<a class="anchor" aria-label="anchor" href="#fitted-and-plot-methods"></a>
</h3>
<p>The <code>fitted</code> method provides the mean of the posterior
predictive distribution for the observed data points. We can also
<code>plot</code> the fitted values against the observed data for a
specific location.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">fitted_values</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  30 100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">fitted_values</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        V1               V2               V3              V4        </span></span>
<span><span class="co">#&gt;  Min.   :-3.851   Min.   :-2.606   Min.   :-2.51   Min.   :-4.797  </span></span>
<span><span class="co">#&gt;  1st Qu.:10.220   1st Qu.:11.281   1st Qu.:11.19   1st Qu.:12.684  </span></span>
<span><span class="co">#&gt;  Median :15.332   Median :16.967   Median :17.18   Median :17.897  </span></span>
<span><span class="co">#&gt;  Mean   :14.714   Mean   :16.067   Mean   :16.61   Mean   :17.348  </span></span>
<span><span class="co">#&gt;  3rd Qu.:19.748   3rd Qu.:21.894   3rd Qu.:22.61   3rd Qu.:23.843  </span></span>
<span><span class="co">#&gt;  Max.   :36.993   Max.   :28.811   Max.   :34.68   Max.   :34.737  </span></span>
<span><span class="co">#&gt;        V5        </span></span>
<span><span class="co">#&gt;  Min.   :-7.604  </span></span>
<span><span class="co">#&gt;  1st Qu.:12.017  </span></span>
<span><span class="co">#&gt;  Median :17.876  </span></span>
<span><span class="co">#&gt;  Mean   :17.463  </span></span>
<span><span class="co">#&gt;  3rd Qu.:22.252  </span></span>
<span><span class="co">#&gt;  Max.   :35.355</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, Y<span class="op">=</span><span class="va">Y</span>, id<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># pick a number between 1 and p</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>The <code>plot</code> method returns an object from the
<code>ggplot2</code> package, so it is straightforward to customize,
save, and arrange multiple plots.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, Y<span class="op">=</span><span class="va">Y</span>, id<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># ggsave("plot1.png", plot = g1)</span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, Y<span class="op">=</span><span class="va">Y</span>, id<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># ggsave("plot2.png", plot = g2)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ID 1"</span>, <span class="st">"#ID 2"</span><span class="op">)</span>, label.x <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>The <code>plot</code> method can also be used to visualize the
time-varying, space-varying, and spacetime-varying coefficients. The
returned object is a <code>ggplot</code> object. The label “Observed”
indicates that the values refer to the observed spatio-temporal data
points. For time-varying and spacetime-varying coefficients, the 95%
credible intervals (CI) are within the dashed lines, whereas for the
space-varying coefficients the posterior standard deviation is shown for
each location.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">'tvc'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span></code></pre>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-3.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coords_sf</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">coords</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">unit_square_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>    <span class="fl">1</span>, <span class="fl">0</span>,</span>
<span>    <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">region</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>  geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">unit_square_coords</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">'svc'</span>, <span class="va">coords_sf</span>, <span class="va">region</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-4.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-5.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span></code></pre>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-6.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">'stvc'</span>, ids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-7.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-8.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span></code></pre>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-13-9.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="trace-plots">Trace plots<a class="anchor" aria-label="anchor" href="#trace-plots"></a>
</h3>
<p>We can also visualize the trace plots of the MCMC samples for the
parameters of interest. For that purpose, we can convert the output to
an <code>mcmc</code> object, then use the <code>plot</code> function
from the <code>coda</code> package.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">sigma2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># measurement error variance</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">Q1inv_time</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># temporal evolution variances for j=1,...,J</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">rho1_space</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># partial sill of spatial effects for j=1,...,J</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-14-3.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">rho2_space</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># range of spatial effects for j=1,...,J</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-14-4.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">rho1_spacetime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># partial sill of spatio-temporal effects for j=1,...,J</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-14-5.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">rho2_spacetime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># range of spatio-temporal effects for j=1,...,J</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-14-6.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">random.walk</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">phi_AR1_time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># AR(1) coefficient for temporal evolution for j=1,...,J</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">phi_AR1_spacetime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># AR(1) coefficient for spatio-temporal evolution for j=1,...,J</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">out</span><span class="op">$</span><span class="va">gamma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#  coefficient of the z covariate</span></span></code></pre></div>
<p><img src="fit_simulated_files/figure-html/unnamed-chunk-14-7.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="restoring-previous-state">Restoring previous state<a class="anchor" aria-label="anchor" href="#restoring-previous-state"></a>
</h3>
<p>The MCMC algorithm has not converged yet, however it is very easy to
continue previous chain. You just need to provide <code>mod</code> as an
argument to the <code>stdglm</code> function. The MCMC will continue
from the last saved state. <em>Note that all previous samples will be
discarded</em>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stdglm.html">stdglm</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, Z<span class="op">=</span><span class="va">z</span>, </span>
<span>              point.referenced<span class="op">=</span><span class="va">point.referenced</span>, </span>
<span>              random.walk<span class="op">=</span><span class="va">random.walk</span>, </span>
<span>              W<span class="op">=</span><span class="va">dist_mat</span>,</span>
<span>              nrep<span class="op">=</span><span class="va">nrep</span>, nburn<span class="op">=</span><span class="va">nburn</span>, thin<span class="op">=</span><span class="va">thin</span>, </span>
<span>              print.interval<span class="op">=</span><span class="va">print.interval</span>, </span>
<span>              prior<span class="op">=</span><span class="va">prior_list</span>,</span>
<span>              last_run <span class="op">=</span> <span class="va">mod</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-selection-and-comparison">Model Selection and Comparison<a class="anchor" aria-label="anchor" href="#model-selection-and-comparison"></a>
</h3>
<p>The <code>stdglm</code> object also contains information for model
selection and comparison, including the Deviance Information Criterion
(DIC), the Widely Applicable Information Criterion (WAIC), and the
Continuous Ranked Probability Score (CRPS). These are all described in a
separate article.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">ave</span><span class="op">$</span><span class="va">DIC</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9116.073</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">ave</span><span class="op">$</span><span class="va">WAIC</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8340.329</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">ave</span><span class="op">$</span><span class="va">CRPS</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.3871759</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carlo Zaccardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
