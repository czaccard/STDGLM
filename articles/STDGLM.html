<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to STDGLM • STDGLM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to STDGLM">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">STDGLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/STDGLM.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01_model_output.html">Details on Model Output</a></li>
    <li><a class="dropdown-item" href="../articles/a02_fit_simulated.html">Simulated Data Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/czaccard/STDGLM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to STDGLM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/czaccard/STDGLM/blob/main/vignettes/STDGLM.Rmd" class="external-link"><code>vignettes/STDGLM.Rmd</code></a></small>
      <div class="d-none name"><code>STDGLM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>STDGLM</code> package provides a framework for fitting
spatio-temporal dynamic generalized linear models. These models are
useful for analyzing data that varies over both space and time, allowing
for the incorporation of spatial and temporal dependencies in the
modeling process. The package provides functions for fitting these
models, as well as tools for visualizing and interpreting the
results.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the package from GitHub using the following
command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"czaccard/STDGLM"</span><span class="op">)</span></span></code></pre></div>
<p>Run the following command to load the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/czaccard/STDGLM" class="external-link">STDGLM</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-usage-example">Quick Usage Example<a class="anchor" aria-label="anchor" href="#quick-usage-example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">AirQualityStation</span><span class="op">)</span><span class="op">)</span> <span class="co"># 51</span></span>
<span><span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>              <span class="co"># 365</span></span>
<span></span>
<span><span class="co"># distance matrix</span></span>
<span><span class="va">W</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">Longitude</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span>, <span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">Latitude</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># response variable: temperature</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">CL_t2m</span>, <span class="va">p</span>, <span class="va">t</span><span class="op">)</span></span>
<span><span class="co"># covariates (intercept + altitude)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">Altitude</span>, <span class="va">p</span>, <span class="va">t</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stdglm.html">stdglm</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>, X<span class="op">=</span><span class="va">X</span>, W<span class="op">=</span><span class="va">W</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="detailed-explanation-on-supported-stdglms">Detailed Explanation on supported STDGLMs<a class="anchor" aria-label="anchor" href="#detailed-explanation-on-supported-stdglms"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
denote the number of <em>spatial units</em> (either georeferenced
locations or areal units) where data is collected, and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
denote the number of <em>time points</em>. As for the current version of
the package (<code>0.0.0.9000</code>), only Gaussian outcomes are
supported. Specifically only dynamic linear models (DLMs) with the
following <strong>observation equation</strong> can be handled:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>𝐱</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mi>′</mi><msub><mi>𝛃</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>𝐳</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mi>′</mi><mi>𝛄</mi><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
    y_{it} = \boldsymbol{x}_{it}' \boldsymbol{\beta}_{it} + \boldsymbol{z}_{it}' \boldsymbol{\gamma} + \epsilon_{it}, \quad \epsilon_{it} \sim N(0, \sigma_\epsilon^2)
</annotation></semantics></math> where:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">y_{it}</annotation></semantics></math>
is the response variable at spatial unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">i=1, \dots, p</annotation></semantics></math>
and time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t=1, \dots, T</annotation></semantics></math>,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐱</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi><mi>t</mi></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>J</mi><mo>,</mo><mi>i</mi><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{x}_{it} = (x_{1,it}, \dots, x_{J,it})'</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>-dimensional
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">J\ge 1</annotation></semantics></math>)
vector of covariates at spatial unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
(an intercept may or may not be included here),</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛃</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi><mi>t</mi></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mrow><mi>J</mi><mo>,</mo><mi>i</mi><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}_{it} = (\beta_{1,it}, \dots, \beta_{J,it})'</annotation></semantics></math>
is the state vector at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
at spatial unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐳</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{z}_{it}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>-dimensional
vector of covariates whose effects are constant (an intercept may or may
not be included here),</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>
is a vector of non-varying coefficients,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{it}</annotation></semantics></math>
is the observation error at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
at spatial unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p></li>
</ul>
<p>The evolution of the state vector is described by the following
<strong>state equation</strong>, which accounts for spatial correlations
in the state vector:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>𝐅</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><msub><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>𝛈</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>𝛈</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>∼</mo><msub><mi>N</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>𝚺</mi><mrow><mi>η</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">
    \boldsymbol{\beta}_{j, t} = \boldsymbol{F}_{j,t} \boldsymbol{\beta}_{j, t-1} + \boldsymbol{\eta}_{j,t}, \quad \boldsymbol{\eta}_{j,t} \sim N_p(0, \boldsymbol{\Sigma}_{\eta, j}), \quad j=1, \dots, J
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn><mi>t</mi></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mi>p</mi><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}_{j,t} = (\beta_{j,1t}, \dots, \beta_{j,pt})'</annotation></semantics></math>
is the state vector related to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
covariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn><mi>t</mi></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>j</mi><mo>,</mo><mi>p</mi><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">x_{j,t} = (x_{j,1t}, \dots, x_{j,pt})'</annotation></semantics></math>,
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
for all spatial units,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐅</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msubsup><mi>ϕ</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msub><mi>𝐈</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{F}_{j,t} = \phi_j^{(\mathsf{T})} \boldsymbol{I}_p</annotation></semantics></math>
is a transition matrix,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝚺</mi><mrow><mi>η</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\Sigma}_{\eta,j}</annotation></semantics></math>
is the covariance matrix of the state evolution error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛈</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{j,t}</annotation></semantics></math>.</p></li>
</ul>
<p>The transition matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐅</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>J</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{F}_{j,t}, j=1, \dots, J,</annotation></semantics></math>
is assumed to be a scalar multiple of the identity matrix. The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ϕ</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\phi_j^{(\mathsf{T})}</annotation></semantics></math>
controls the temporal autocorrelation of the state vector.</p>
<p>The state evolution covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝚺</mi><mrow><mi>η</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\Sigma}_{\eta,j}</annotation></semantics></math>
can be structured to reflect <em>spatial relationships</em>, e.g. by
assuming an <strong>exponential covariance function</strong> if the data
are point-referenced:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝚺</mi><mrow><mi>η</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mo>ℓ</mo></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><msub><mi>d</mi><mrow><mi>i</mi><mo>ℓ</mo></mrow></msub><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>d</mi><mrow><mi>i</mi><mo>ℓ</mo></mrow></msub><mo>=</mo><mo stretchy="false" form="postfix">∥</mo><msub><mi>𝐬</mi><mi>i</mi></msub><mo>−</mo><msub><mi>𝐬</mi><mo>ℓ</mo></msub><mo stretchy="false" form="postfix">∥</mo></mrow><annotation encoding="application/x-tex">
        (\boldsymbol{\Sigma}_{\eta,j})_{i\ell} = \rho_{j,2} \exp\left(-\frac{d_{i\ell}}{\rho_{j,2}}\right), \quad d_{i\ell} = \| \boldsymbol{s}_i - \boldsymbol{s}_\ell \|
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\rho_{j,1}</annotation></semantics></math>
is the partial sill,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">\rho_{j,2}</annotation></semantics></math>
is the range parameter, and $ d_{i}$ is the Euclidean distance between
locations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐬</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\boldsymbol{s}_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐬</mi><mo>ℓ</mo></msub><annotation encoding="application/x-tex">\boldsymbol{s}_\ell</annotation></semantics></math>.
At the moment, this is the only supported covariance structure for
point-referenced data.</p>
<p>In this case, the evolution error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛈</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{j,t}</annotation></semantics></math>
is assumed to be a zero-mean Gaussian process with exponential
covariance matrix parameteterized by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\rho_{j,1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">\rho_{j,2}</annotation></semantics></math>,
which we will denote as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛈</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>∼</mo><mi>G</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta}_{j,t} \sim GP(0, \rho_{j,1}, \rho_{j,2}; exp)</annotation></semantics></math>.</p>
<p>If the data are areal, a <strong>proper conditional autoregressive
(PCAR) covariance structure</strong> is assumed:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝚺</mi><mrow><mi>η</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐃</mi><mi>w</mi></msub><mo>−</mo><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mi>𝐖</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
    \boldsymbol{\Sigma}_{\eta,j} = \rho_{j,1} \left( \boldsymbol{D}_w - \rho_{j,2} \boldsymbol{W} \right)^{-1}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐖</mi><annotation encoding="application/x-tex">\boldsymbol{W}</annotation></semantics></math>
is a binary adjacency matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐃</mi><mi>w</mi></msub><annotation encoding="application/x-tex">\boldsymbol{D}_w</annotation></semantics></math>
is a diagonal matrix with row sums of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐖</mi><annotation encoding="application/x-tex">\boldsymbol{W}</annotation></semantics></math>
on the diagonal, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\rho_{j,1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><annotation encoding="application/x-tex">\rho_{j,2}</annotation></semantics></math>
are the conditional variance and autocorrelation parameters,
respectively.</p>
<p>In this case, the evolution error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛈</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\eta}_{j,t}</annotation></semantics></math>
follows a zero-mean PCAR process, and we will denote this as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛈</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>∼</mo><mi>P</mi><mi>C</mi><mi>A</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta}_{j,t} \sim PCAR(0, \rho_{j,1}, \rho_{j,2})</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="anova-decomposition-of-the-state-vector">ANOVA Decomposition of the State Vector<a class="anchor" aria-label="anchor" href="#anova-decomposition-of-the-state-vector"></a>
</h3>
<p>The function <code>stdglm</code> allows for the decomposition of the
state vector into components that can be interpreted as contributions
from different sources of variability. Dropping the subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
for the sake of simplicity, the state vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\beta_{it}</annotation></semantics></math>
is decomposed as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>=</mo><mover><mi>β</mi><mo accent="true">¯</mo></mover><mo>+</mo><msubsup><mi>β</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>β</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>β</mi><mrow><mi>i</mi><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">
\beta_{it} = \overline{\beta} + \beta_{i}^{(\mathsf{S})} + \beta_{t}^{(\mathsf{T})} + \beta_{it}^{(\mathsf{ST})}
</annotation></semantics></math> where:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>β</mi><mo accent="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{\beta}</annotation></semantics></math>
is the overall mean effect,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>β</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\beta_{i}^{(\mathsf{S})}</annotation></semantics></math>
is the spatial effect at spatial unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>β</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\beta_{t}^{(\mathsf{T})}</annotation></semantics></math>
is the temporal effect at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>β</mi><mrow><mi>i</mi><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\beta_{it}^{(\mathsf{ST})}</annotation></semantics></math>
is the interaction effect between space and time at spatial unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="bayesian-hierarchical-structure">Bayesian Hierarchical Structure<a class="anchor" aria-label="anchor" href="#bayesian-hierarchical-structure"></a>
</h3>
<p>The Bayesian model is as follows, for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t=1, \dots, T</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">j=1, \dots, J</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>y</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mi>′</mi><msub><mi>𝛃</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>𝐳</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mi>′</mi><mi>𝛄</mi><mo>,</mo><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mn>𝟏</mn><mi>p</mi></msub><msub><mover><mi>β</mi><mo accent="true">¯</mo></mover><mi>j</mi></msub><mo>+</mo><msubsup><mi>𝛃</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msub><mn>𝟏</mn><mi>p</mi></msub><msubsup><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><msub><mi>𝛃</mi><mi>𝐣</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mi>p</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mo>∼</mo><mi>G</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> or </mtext><mspace width="0.333em"></mspace></mrow><mi>P</mi><mi>C</mi><mi>A</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ϕ</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msubsup><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>V</mi><mrow><mi>β</mi><mo>,</mo><mi>j</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>β</mi><mrow><mi>j</mi><mo>,</mo><mi>p</mi><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mo>∼</mo><mi>G</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ϕ</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msubsup><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> or </mtext><mspace width="0.333em"></mspace></mrow><mi>P</mi><mi>C</mi><mi>A</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ϕ</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msubsup><mi>𝛃</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>ρ</mi><mrow><mi>j</mi><mo>,</mo><mn>2</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    y_{it} &amp;\sim N(\boldsymbol{x}_{it}' \boldsymbol{\beta}_{it} + \boldsymbol{z}_{it}' \boldsymbol{\gamma}, \sigma_\epsilon^2) \\
    \boldsymbol{\beta}_{j,t} &amp;= \boldsymbol{1}_p \overline{\beta}_j + \boldsymbol{\beta}_j^{(\mathsf{S})} + \boldsymbol{1}_p \beta_{j,t}^{(\mathsf{T})} + \boldsymbol{\beta}_{j,t}^{(\mathsf{ST})} \\
    \boldsymbol{\beta_j}^{(\mathsf{S})} &amp;= (\beta_{j,1}^{(\mathsf{S})}, \dots, \beta_{j,p}^{(\mathsf{S})})' \sim GP(0, \rho_{j,1}^{(\mathsf{S})}, \rho_{j,2}^{(\mathsf{S})}; exp) \mbox{ or } PCAR(0, \rho_{j,1}^{(\mathsf{S})}, \rho_{j,2}^{(\mathsf{S})}) \\
    \beta_{j,t}^{(\mathsf{T})} &amp;\sim N(\phi_j^{(\mathsf{T})} \beta_{j,t-1}^{(\mathsf{T})}, V_{\beta,j}^{(\mathsf{T})}) \\
    \boldsymbol{\beta}_{j,t}^{(\mathsf{ST})} &amp;= (\beta_{j,1t}^{(\mathsf{ST})}, \dots, \beta_{j,pt}^{(\mathsf{ST})})' \sim GP(\phi_j^{(\mathsf{ST})} \boldsymbol{\beta}_{j,t-1}^{(\mathsf{ST})}, \rho_{j,1}^{(\mathsf{ST})}, \rho_{j,2}^{(\mathsf{ST})}; exp) \mbox{ or } PCAR(\phi_j^{(\mathsf{ST})} \boldsymbol{\beta}_{j,t-1}^{(\mathsf{ST})}, \rho_{j,1}^{(\mathsf{ST})}, \rho_{j,2}^{(\mathsf{ST})})
\end{align*}</annotation></semantics></math></p>
<p>The model is completed with the following priors (again, dropping the
subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
since these are common across
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>β</mi><mo accent="true">¯</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>V</mi><mi>γ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>β</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>V</mi><msub><mi>β</mi><mn>0</mn></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>𝛃</mi><mn>0</mn><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><msub><mi>N</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>V</mi><msub><mi>β</mi><mn>0</mn></msub></msub><msub><mi>𝐈</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>𝛄</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><msub><mi>N</mi><mi>q</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>V</mi><mi>γ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>I</mi><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>ϵ</mi></msub><mo>,</mo><msub><mi>b</mi><mi>ϵ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>ρ</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>I</mi><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.01</mn><mo>,</mo><mn>0.01</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>ρ</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>ρ</mi></msub><mo>,</mo><msub><mi>b</mi><mi>ρ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>ρ</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>I</mi><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.01</mn><mo>,</mo><mn>0.01</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>ρ</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>ρ</mi></msub><mo>,</mo><msub><mi>b</mi><mi>ρ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>T</mi><msub><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>T</mi><msub><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>V</mi><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>I</mi><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \overline{\beta} &amp;\sim N(0, V_\gamma) \\
    \beta_{0}^{(\mathsf{T})} &amp;\sim N(0, V_{\beta_0}) \\
    \boldsymbol{\beta}_{0}^{(\mathsf{ST})} &amp;\sim N_p(0, V_{\beta_0} \boldsymbol{I}_p) \\
    \boldsymbol{\gamma} &amp;\sim N_q(0, V_\gamma) \\
    \sigma_\epsilon^2 &amp;\sim IG(a_\epsilon, b_\epsilon) \\
    \rho_1^{(\mathsf{S})} &amp;\sim IG(0.01, 0.01) \\
    \rho_2^{(\mathsf{S})} &amp;\sim U(a_\rho, b_\rho) \\
    \rho_1^{(\mathsf{ST})} &amp;\sim IG(0.01, 0.01) \\
    \rho_2^{(\mathsf{ST})} &amp;\sim U(a_\rho, b_\rho) \\
    \phi^{(\mathsf{T})} &amp;\sim TN_{(-1, 1)}(0, 1) \\
    \phi^{(\mathsf{ST})} &amp;\sim TN_{(-1, 1)}(0, 1) \\
    V_\beta^{(\mathsf{T})} &amp;\sim IG(a^{(\mathsf{T})}, b^{(\mathsf{T})})
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><msub><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">TN_{(q, r)}(\mu, \sigma^2)</annotation></semantics></math>
denotes a normal distribution with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
truncated to the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(q, r)</annotation></semantics></math>.
The hyperparameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>ρ</mi></msub><annotation encoding="application/x-tex">a_\rho</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>ρ</mi></msub><annotation encoding="application/x-tex">b_\rho</annotation></semantics></math>
depend on the type of spatial data. If the data are point-referenced,
they are set based on the minimum and maximum distances between points,
respectively. If the data are areal,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>ρ</mi></msub><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">a_\rho= 0.1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>ρ</mi></msub><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b_\rho \rightarrow 1</annotation></semantics></math>.</p>
<p>Note that the spacetime-varying coefficients are assumed independent
a priori across
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">j=1,\dots,J</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="efficient-inference-and-identifiability">Efficient Inference and Identifiability<a class="anchor" aria-label="anchor" href="#efficient-inference-and-identifiability"></a>
</h3>
<p>To build an efficient sampler, the algorithm proposed by <span class="citation">Chan and Jeliazkov (2009)</span> is used in conjuction
with sparse matrix techniques.</p>
<p>To make the model identifiable, some <strong>constraints</strong> are
imposed on the varying parameters at each MCMC iteration:</p>
<ul>
<li><p>Set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mi>β</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖳</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{t=1}^{T} \beta_{t}^{(\mathsf{T})} = 0</annotation></semantics></math>.</p></li>
<li><p>Set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msubsup><mi>β</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝖲</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{p} \beta_{i}^{(\mathsf{S})} = 0</annotation></semantics></math>.</p></li>
<li><p>Set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msubsup><mi>β</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{p} \beta_{i,t}^{(\mathsf{ST})} = 0</annotation></semantics></math>
for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t=1,\dots,T</annotation></semantics></math>.</p></li>
<li><p>Set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mi>β</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>𝖲</mi><mi>𝖳</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{t=1}^{T} \beta_{i,t}^{(\mathsf{ST})} = 0</annotation></semantics></math>
for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">i=1,\dots,p</annotation></semantics></math>.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-chan2009efficient" class="csl-entry">
Chan, Joshua CC, and Ivan Jeliazkov. 2009. <span>“Efficient Simulation
and Integrated Likelihood Estimation in State Space Models.”</span>
<em>International Journal of Mathematical Modelling and Numerical
Optimisation</em> 1 (1-2): 101–20.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carlo Zaccardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
