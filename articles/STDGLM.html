<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to STDGLM • STDGLM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to STDGLM">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">STDGLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/STDGLM.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01_model_output.html">Details on Model Output</a></li>
    <li><a class="dropdown-item" href="../articles/a02_fit_simulated.html">Simulated Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/a03_apulia_aq.html">Analysis of Apulia Air Quality Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/czaccard/STDGLM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to STDGLM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/czaccard/STDGLM/blob/main/vignettes/STDGLM.Rmd" class="external-link"><code>vignettes/STDGLM.Rmd</code></a></small>
      <div class="d-none name"><code>STDGLM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>STDGLM</code> package provides a framework for fitting
spatio-temporal dynamic generalized linear models. These models are
useful for analyzing data that varies over both space and time, allowing
for the incorporation of spatial and temporal dependencies in the
modeling process. The package provides functions for fitting these
models, as well as tools for visualizing and interpreting the
results.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the package from GitHub using the following
command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"czaccard/STDGLM"</span><span class="op">)</span></span></code></pre></div>
<p>Run the following command to load the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/czaccard/STDGLM" class="external-link">STDGLM</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-usage-example">Quick Usage Example<a class="anchor" aria-label="anchor" href="#quick-usage-example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">AirQualityStation</span><span class="op">)</span><span class="op">)</span> <span class="co"># 51</span></span>
<span><span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>              <span class="co"># 365</span></span>
<span></span>
<span><span class="co"># distance matrix</span></span>
<span><span class="va">W</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">Longitude</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span>, <span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">Latitude</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># response variable: temperature</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">CL_t2m</span>, <span class="va">p</span>, <span class="va">t</span><span class="op">)</span></span>
<span><span class="co"># covariates (intercept + altitude)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ApuliaAQ</span><span class="op">$</span><span class="va">Altitude</span>, <span class="va">p</span>, <span class="va">t</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stdglm.html">stdglm</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>, X<span class="op">=</span><span class="va">X</span>, W<span class="op">=</span><span class="va">W</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="detailed-explanation-on-supported-stdglms">Detailed Explanation on supported STDGLMs<a class="anchor" aria-label="anchor" href="#detailed-explanation-on-supported-stdglms"></a>
</h2>
<p>Let <span class="math inline">p</span> denote the number of
<em>spatial units</em> (either georeferenced locations or areal units)
where data is collected, and let <span class="math inline">T</span>
denote the number of <em>time points</em>. Generalized dynamic linear
models (GDLMs) with the following <strong>observation equation</strong>
can be handled: <span class="math display">
    y_{it} \sim F \\
    \eta_{it} = g\left(E\left( y_{it} \right)\right) =
\boldsymbol{x}_{it}' \boldsymbol{\beta}_{it} +
\boldsymbol{z}_{it}' \boldsymbol{\gamma} + \epsilon_{it}, \quad
\epsilon_{it} \sim N(0, \sigma_\epsilon^2)
</span> where:</p>
<ul>
<li><p><span class="math inline">y_{it}</span> is the response variable
at spatial unit <span class="math inline">i=1, \dots, p</span> and time
<span class="math inline">t=1, \dots, T</span>, following an exponential
family distribution <span class="math inline">F</span>,</p></li>
<li><p><span class="math inline">\eta_{it}</span> is the corresponding
linear predictor, defined using a non-linear link function <span class="math inline">g(\cdot)</span>,</p></li>
<li><p><span class="math inline">\boldsymbol{x}_{it} = (x_{1,it}, \dots,
x_{J,it})'</span> is a <span class="math inline">J</span>-dimensional (<span class="math inline">J\ge
1</span>) vector of covariates at spatial unit <span class="math inline">i</span> at time <span class="math inline">t</span>
(an intercept may or may not be included here),</p></li>
<li><p><span class="math inline">\boldsymbol{\beta}_{it} =
(\beta_{1,it}, \dots, \beta_{J,it})'</span> is the state vector at
time <span class="math inline">t</span> at spatial unit <span class="math inline">i</span>,</p></li>
<li><p><span class="math inline">\boldsymbol{z}_{it}</span> is a <span class="math inline">q</span>-dimensional vector of covariates whose
effects are constant (an intercept may or may not be included
here),</p></li>
<li><p><span class="math inline">\boldsymbol{\gamma}</span> is a vector
of non-varying coefficients,</p></li>
<li><p><span class="math inline">\epsilon_{it}</span> is the observation
error at time <span class="math inline">t</span> at spatial unit <span class="math inline">i</span>.</p></li>
</ul>
<p>The evolution of the state vector is described by the following
<strong>state equation</strong>, which accounts for spatial correlations
in the state vector: <span class="math display">
    \boldsymbol{\beta}_{j, t} = \boldsymbol{F}_{j,t}
\boldsymbol{\beta}_{j, t-1} + \boldsymbol{\eta}_{j,t}, \quad
\boldsymbol{\eta}_{j,t} \sim N_p(0, \boldsymbol{\Sigma}_{\eta, j}),
\quad j=1, \dots, J
</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\boldsymbol{\beta}_{j,t} =
(\beta_{j,1t}, \dots, \beta_{j,pt})'</span> is the state vector
related to the <span class="math inline">j</span>-th covariate <span class="math inline">x_{j,t} = (x_{j,1t}, \dots, x_{j,pt})'</span>,
at time <span class="math inline">t</span> for all spatial
units,</p></li>
<li><p><span class="math inline">\boldsymbol{F}_{j,t} =
\phi_j^{(\mathsf{T})} \boldsymbol{I}_p</span> is a transition
matrix,</p></li>
<li><p><span class="math inline">\boldsymbol{\Sigma}_{\eta,j}</span> is
the covariance matrix of the state evolution error <span class="math inline">\boldsymbol{\eta}_{j,t}</span>.</p></li>
</ul>
<p>The transition matrix <span class="math inline">\boldsymbol{F}_{j,t},
j=1, \dots, J,</span> is assumed to be a scalar multiple of the identity
matrix. The parameter <span class="math inline">\phi_j^{(\mathsf{T})}</span> controls the temporal
autocorrelation of the state vector.</p>
<p>The state evolution covariance matrix <span class="math inline">\boldsymbol{\Sigma}_{\eta,j}</span> can be
structured to reflect <em>spatial relationships</em>, e.g. by assuming
an <strong>exponential covariance function</strong> if the data are
point-referenced: <span class="math display">
        (\boldsymbol{\Sigma}_{\eta,j})_{i\ell} = \rho_{j,2}
\exp\left(-\frac{d_{i\ell}}{\rho_{j,2}}\right), \quad d_{i\ell} = \|
\boldsymbol{s}_i - \boldsymbol{s}_\ell \|
</span> where <span class="math inline">\rho_{j,1}</span> is the partial
sill, <span class="math inline">\rho_{j,2}</span> is the range
parameter, and $ d_{i}$ is the Euclidean distance between locations
<span class="math inline">\boldsymbol{s}_i</span> and <span class="math inline">\boldsymbol{s}_\ell</span>. At the moment, this is
the only supported covariance structure for point-referenced data.</p>
<p>In this case, the evolution error <span class="math inline">\boldsymbol{\eta}_{j,t}</span> is assumed to be a
zero-mean Gaussian process with exponential covariance matrix
parameteterized by <span class="math inline">\rho_{j,1}</span> and <span class="math inline">\rho_{j,2}</span>, which we will denote as <span class="math inline">\boldsymbol{\eta}_{j,t} \sim GP(0, \rho_{j,1},
\rho_{j,2}; exp)</span>.</p>
<p>If the data are areal, a <strong>proper conditional autoregressive
(PCAR) covariance structure</strong> is assumed: <span class="math display">
    \boldsymbol{\Sigma}_{\eta,j} = \rho_{j,1} \left( \boldsymbol{D}_w -
\rho_{j,2} \boldsymbol{W} \right)^{-1}
</span> where <span class="math inline">\boldsymbol{W}</span> is a
binary adjacency matrix, <span class="math inline">\boldsymbol{D}_w</span> is a diagonal matrix with
row sums of <span class="math inline">\boldsymbol{W}</span> on the
diagonal, and <span class="math inline">\rho_{j,1}</span> and <span class="math inline">\rho_{j,2}</span> are the conditional variance and
autocorrelation parameters, respectively.</p>
<p>In this case, the evolution error <span class="math inline">\boldsymbol{\eta}_{j,t}</span> follows a zero-mean
PCAR process, and we will denote this as <span class="math inline">\boldsymbol{\eta}_{j,t} \sim PCAR(0, \rho_{j,1},
\rho_{j,2})</span>.</p>
<div class="section level3">
<h3 id="supported-distributions">Supported Distributions<a class="anchor" aria-label="anchor" href="#supported-distributions"></a>
</h3>
<p>As for version <code>0.1.1</code>, the following distributions for
the outcome are supported: Gaussian, Poisson, Bernoulli.</p>
</div>
<div class="section level3">
<h3 id="anova-decomposition-of-the-state-vector">ANOVA Decomposition of the State Vector<a class="anchor" aria-label="anchor" href="#anova-decomposition-of-the-state-vector"></a>
</h3>
<p>The function <code>stdglm</code> allows for the decomposition of the
state vector into components that can be interpreted as contributions
from different sources of variability. Dropping the subscript <span class="math inline">j</span> for the sake of simplicity, the state
vector <span class="math inline">\beta_{it}</span> is decomposed as
follows: <span class="math display">
\beta_{it} = \overline{\beta} + \beta_{i}^{(\mathsf{S})} +
\beta_{t}^{(\mathsf{T})} + \beta_{it}^{(\mathsf{ST})}
</span> where:</p>
<ul>
<li><p><span class="math inline">\overline{\beta}</span> is the overall
mean effect,</p></li>
<li><p><span class="math inline">\beta_{i}^{(\mathsf{S})}</span> is the
spatial effect at spatial unit <span class="math inline">i</span>,</p></li>
<li><p><span class="math inline">\beta_{t}^{(\mathsf{T})}</span> is the
temporal effect at time <span class="math inline">t</span>,</p></li>
<li><p><span class="math inline">\beta_{it}^{(\mathsf{ST})}</span> is
the interaction effect between space and time at spatial unit <span class="math inline">i</span> and time <span class="math inline">t</span>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="bayesian-hierarchical-structure">Bayesian Hierarchical Structure<a class="anchor" aria-label="anchor" href="#bayesian-hierarchical-structure"></a>
</h3>
<p>For Gaussian outcomes, the Bayesian model is as follows, for <span class="math inline">t=1, \dots, T</span> and <span class="math inline">j=1, \dots, J</span> (generalization to other
distributions is straightforward): <span class="math display">\begin{align*}
    y_{it} &amp;\sim N(\boldsymbol{x}_{it}' \boldsymbol{\beta}_{it}
+ \boldsymbol{z}_{it}' \boldsymbol{\gamma}, \sigma_\epsilon^2) \\
    \boldsymbol{\beta}_{j,t} &amp;= \boldsymbol{1}_p \overline{\beta}_j
+ \boldsymbol{\beta}_j^{(\mathsf{S})} + \boldsymbol{1}_p
\beta_{j,t}^{(\mathsf{T})} + \boldsymbol{\beta}_{j,t}^{(\mathsf{ST})} \\
    \boldsymbol{\beta_j}^{(\mathsf{S})} &amp;=
(\beta_{j,1}^{(\mathsf{S})}, \dots, \beta_{j,p}^{(\mathsf{S})})'
\sim GP(0, \rho_{j,1}^{(\mathsf{S})}, \rho_{j,2}^{(\mathsf{S})}; exp)
\mbox{ or } PCAR(0, \rho_{j,1}^{(\mathsf{S})},
\rho_{j,2}^{(\mathsf{S})}) \\
    \beta_{j,t}^{(\mathsf{T})} &amp;\sim N(\phi_j^{(\mathsf{T})}
\beta_{j,t-1}^{(\mathsf{T})}, V_{\beta,j}^{(\mathsf{T})}) \\
    \boldsymbol{\beta}_{j,t}^{(\mathsf{ST})} &amp;=
(\beta_{j,1t}^{(\mathsf{ST})}, \dots, \beta_{j,pt}^{(\mathsf{ST})})'
\sim GP(\phi_j^{(\mathsf{ST})}
\boldsymbol{\beta}_{j,t-1}^{(\mathsf{ST})}, \rho_{j,1}^{(\mathsf{ST})},
\rho_{j,2}^{(\mathsf{ST})}; exp) \mbox{ or } PCAR(\phi_j^{(\mathsf{ST})}
\boldsymbol{\beta}_{j,t-1}^{(\mathsf{ST})}, \rho_{j,1}^{(\mathsf{ST})},
\rho_{j,2}^{(\mathsf{ST})})
\end{align*}</span></p>
<p>The model is completed with the following priors (again, dropping the
subscript <span class="math inline">j</span>, since these are common
across <span class="math inline">j</span>): <span class="math display">\begin{align*}
    \overline{\beta} &amp;\sim N(0, V_\gamma) \\
    \beta_{0}^{(\mathsf{T})} &amp;\sim N(0, V_{\beta_0}) \\
    \boldsymbol{\beta}_{0}^{(\mathsf{ST})} &amp;\sim N_p(0, V_{\beta_0}
\boldsymbol{I}_p) \\
    \boldsymbol{\gamma} &amp;\sim N_q(0, V_\gamma) \\
    \sigma_\epsilon^2 &amp;\sim IG(a_\epsilon, b_\epsilon) \\
    \rho_1^{(\mathsf{S})} &amp;\sim IG(a_{\rho, S}, b_{\rho, S}) \\
    \rho_2^{(\mathsf{S})} &amp;\sim U(min_\rho, max_\rho) \\
    \rho_1^{(\mathsf{ST})} &amp;\sim IG(a_{\rho, ST}, b_{\rho, ST}) \\
    \rho_2^{(\mathsf{ST})} &amp;\sim U(min_\rho, max_\rho) \\
    \phi^{(\mathsf{T})} &amp;\sim TN_{(-1, 1)}(0, 1) \\
    \phi^{(\mathsf{ST})} &amp;\sim TN_{(-1, 1)}(0, 1) \\
    V_\beta^{(\mathsf{T})} &amp;\sim IG(a^{(\mathsf{T})},
b^{(\mathsf{T})})
\end{align*}</span> where <span class="math inline">TN_{(q, r)}(\mu,
\sigma^2)</span> denotes a normal distribution with mean <span class="math inline">\mu</span> and variance <span class="math inline">\sigma^2</span> truncated to the interval <span class="math inline">(q, r)</span>. The hyperparameters <span class="math inline">min_\rho</span> and <span class="math inline">max_\rho</span> depend on the type of spatial data.
If the data are point-referenced, they are set to the minimum and
maximum distances between points divided by 3, respectively. If the data
are areal, <span class="math inline">min_\rho= 0.1</span> and <span class="math inline">max_\rho \rightarrow 1</span>.</p>
<p>Note that the spacetime-varying coefficients are assumed independent
a priori across <span class="math inline">j=1,\dots,J</span>.</p>
</div>
<div class="section level3">
<h3 id="efficient-inference-and-identifiability">Efficient Inference and Identifiability<a class="anchor" aria-label="anchor" href="#efficient-inference-and-identifiability"></a>
</h3>
<p>To build an efficient sampler, the algorithm proposed by <span class="citation">Chan and Jeliazkov (2009)</span> is used in conjuction
with sparse matrix techniques.</p>
<p>To make the model identifiable, some <strong>constraints</strong> are
imposed on the varying parameters at each MCMC iteration:</p>
<ul>
<li><p>Set <span class="math inline">\sum_{t=1}^{T}
\beta_{t}^{(\mathsf{T})} = 0</span>.</p></li>
<li><p>Set <span class="math inline">\sum_{i=1}^{p}
\beta_{i}^{(\mathsf{S})} = 0</span>.</p></li>
<li><p>Set <span class="math inline">\sum_{i=1}^{p}
\beta_{i,t}^{(\mathsf{ST})} = 0</span> for each <span class="math inline">t=1,\dots,T</span>.</p></li>
<li><p>Set <span class="math inline">\sum_{t=1}^{T}
\beta_{i,t}^{(\mathsf{ST})} = 0</span> for each <span class="math inline">i=1,\dots,p</span>.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-chan2009efficient" class="csl-entry">
Chan, Joshua CC, and Ivan Jeliazkov. 2009. <span>“Efficient Simulation
and Integrated Likelihood Estimation in State Space Models.”</span>
<em>International Journal of Mathematical Modelling and Numerical
Optimisation</em> 1 (1-2): 101–20.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carlo Zaccardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
